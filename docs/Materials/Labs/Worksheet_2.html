<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HOME - Worksheet 6</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../..//site_pics/SOC2069_logo_noaxis.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="../../site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet">
<link href="../../site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet">
<script src="../../site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>


<link rel="stylesheet" href="labcss.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">HOME</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../Structure.html" rel="" target="">
 <span class="menu-text">Module structure</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Materials/Labs/Worksheet_1.html" rel="" target="">
 <span class="menu-text">Week 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../Materials/Labs/Worksheet_2.html" rel="" target="" aria-current="page">
 <span class="menu-text">Week 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ttt" rel="" target="">
 <span class="menu-text">Week 3</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Materials/Labs/Worksheet_4.html" rel="" target="">
 <span class="menu-text">Week 4</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Materials/Labs/Worksheet_5.html" rel="" target="">
 <span class="menu-text">Week 5</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ttt" rel="" target="">
 <span class="menu-text">Week 6</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ttt" rel="" target="">
 <span class="menu-text">Week 7</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ttt" rel="" target="">
 <span class="menu-text">Week 8</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ttt" rel="" target="">
 <span class="menu-text">Week 9</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ttt" rel="" target="">
 <span class="menu-text">Week 10</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ttt" rel="" target="">
 <span class="menu-text">Assessment</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://ncl.instructure.com/courses/53153" rel="" target=""><i class="bi bi-house-lock" role="img" aria-label="Canvas page (Newcastle University login required)">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#readings" id="toc-readings" class="nav-link" data-scroll-target="#readings">Readings</a></li>
  <li><a href="#exercise-1-getting-to-know-the-rstudio-interface" id="toc-exercise-1-getting-to-know-the-rstudio-interface" class="nav-link" data-scroll-target="#exercise-1-getting-to-know-the-rstudio-interface">Exercise 1: Getting to know the RStudio interface</a>
  <ul class="collapse">
  <li><a href="#task-1-open-an-rstudio-project" id="toc-task-1-open-an-rstudio-project" class="nav-link" data-scroll-target="#task-1-open-an-rstudio-project">Task 1: Open an RStudio project</a></li>
  <li><a href="#task-2-using-r-scripts" id="toc-task-2-using-r-scripts" class="nav-link" data-scroll-target="#task-2-using-r-scripts">Task 2: Using R scripts</a></li>
  <li><a href="#task-3-explore-the-rstudio-main-panes" id="toc-task-3-explore-the-rstudio-main-panes" class="nav-link" data-scroll-target="#task-3-explore-the-rstudio-main-panes">Task 3: Explore the RStudio (main) Panes</a>
  <ul class="collapse">
  <li><a href="#the-r-console-pane" id="toc-the-r-console-pane" class="nav-link" data-scroll-target="#the-r-console-pane">The R Console Pane</a></li>
  <li><a href="#the-source-pane" id="toc-the-source-pane" class="nav-link" data-scroll-target="#the-source-pane">The Source Pane</a></li>
  <li><a href="#the-environment-pane" id="toc-the-environment-pane" class="nav-link" data-scroll-target="#the-environment-pane">The Environment Pane</a></li>
  <li><a href="#files-plots-packages-help-etc" id="toc-files-plots-packages-help-etc" class="nav-link" data-scroll-target="#files-plots-packages-help-etc">Files, Plots, Packages, Help, etc</a></li>
  </ul></li>
  <li><a href="#task-4-start-using-functions-and-user-written-packages" id="toc-task-4-start-using-functions-and-user-written-packages" class="nav-link" data-scroll-target="#task-4-start-using-functions-and-user-written-packages">Task 4: Start using functions and user-written packages</a>
  <ul class="collapse">
  <li><a href="#installing-and-loading-the-tidyverse" id="toc-installing-and-loading-the-tidyverse" class="nav-link" data-scroll-target="#installing-and-loading-the-tidyverse">Installing and loading the <code>tidyverse</code></a></li>
  <li><a href="#installing-some-other-packages" id="toc-installing-some-other-packages" class="nav-link" data-scroll-target="#installing-some-other-packages">Installing some other packages</a></li>
  <li><a href="#load-a-dataset" id="toc-load-a-dataset" class="nav-link" data-scroll-target="#load-a-dataset">Load a dataset</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exercise-2-explore-the-understanding-society-wave-8-dataset" id="toc-exercise-2-explore-the-understanding-society-wave-8-dataset" class="nav-link" data-scroll-target="#exercise-2-explore-the-understanding-society-wave-8-dataset">Exercise 2: Explore the Understanding Society Wave 8 dataset</a></li>
  <li><a href="#exercise-3-basic-descriptive-statistics" id="toc-exercise-3-basic-descriptive-statistics" class="nav-link" data-scroll-target="#exercise-3-basic-descriptive-statistics">Exercise 3: Basic descriptive statistics</a>
  <ul class="collapse">
  <li><a href="#task-3.1-tabulate-categorical-variables" id="toc-task-3.1-tabulate-categorical-variables" class="nav-link" data-scroll-target="#task-3.1-tabulate-categorical-variables">Task 3.1: Tabulate categorical variables</a></li>
  <li><a href="#task-3.2-summarize-numeric-variables" id="toc-task-3.2-summarize-numeric-variables" class="nav-link" data-scroll-target="#task-3.2-summarize-numeric-variables">Task 3.2: Summarize numeric variables</a></li>
  <li><a href="#task-3.3-visualising-distributions" id="toc-task-3.3-visualising-distributions" class="nav-link" data-scroll-target="#task-3.3-visualising-distributions">Task 3.3: Visualising distributions</a></li>
  </ul></li>
  <li><a href="#exercise-4-on-your-own" id="toc-exercise-4-on-your-own" class="nav-link" data-scroll-target="#exercise-4-on-your-own">Exercise 4: On your own</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Worksheet 6</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="cell-output-display">
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
</div>
</div>
<hr>
<pre><code>Timetable week: 11
Topic: "Variables and descriptive statistics"</code></pre>
<hr>
<section id="intro" class="level1">
<h1>Intro</h1>
<p>This week we begin learning how to analyse quantitative data using the free, open-source, statistical analysis programme <code>R</code> via the <code>RStudio</code> interface.</p>
<p>If you did not complete the online <code>R</code>/<code>RStudio</code> training during reading week, complete it as soon as possible. The labs/workshops provide only limited time to complete more substantive quantitative analysis exercises, so you should make sure to get a firmer grasp of the software outside class.</p>
<p>Datacarpentry online training “R for Social Scientists”: <a href="https://datacarpentry.org/r-socialsci" class="uri">https://datacarpentry.org/r-socialsci</a></p>
</section>
<section id="readings" class="level1">
<h1>Readings</h1>
<p>Core readings:</p>
<ul>
<li>Gelman et al.&nbsp;(2020): Chapters 2 (again) and 3 (pp.&nbsp;21–47)</li>
</ul>
<p>Secondary readings:</p>
<ul>
<li>Agresti (2018): Chapters 3 and 4 (pp.&nbsp;29–94)</li>
<li>Byrne (2002): Chapter 6 (pp.&nbsp;95–111)</li>
</ul>
</section>
<section id="exercise-1-getting-to-know-the-rstudio-interface" class="level1">
<h1>Exercise 1: Getting to know the RStudio interface</h1>
<p><code>About 60  minutes</code></p>
<hr>
<p>The term “<code>R</code>” is used to refer to both the programming language and the software that interprets the scripts written using it. To make it easier to interact with R, we will use RStudio. RStudio is the most popular IDE (Integrated Development Environment) for R. An IDE is a piece of software that provides tools to make programming easier. To function correctly, RStudio needs R and therefore both need to be installed on your computer. To install them on your own personal computers (<strong>Windows</strong> or <strong>MacOS</strong>), see the guidance on <a href="https://ncl.instructure.com/courses/48074/pages/software-requirements-and-access?module_item_id=2500821">Canvas</a> or on <a href="https://datacarpentry.org/r-socialsci/setup.html">R for Social Scientists</a>.</p>
<p>R and RStudio should be available on all computers in the IT labs. You can find RStudio among the list of programs (in the Start menu) and open the programme directly. This will open a new RStudio session in the computer’s default working directory. To make sure that all your files and outputs that you create are in the same place and accessible regardless of the computer you are using, it’s best to get into the practice of using RStudio <strong>projects</strong>.</p>
<section id="task-1-open-an-rstudio-project" class="level2">
<h2 class="anchored" data-anchor-id="task-1-open-an-rstudio-project">Task 1: Open an RStudio project</h2>
<p>An <strong>RStudio Project</strong> stores all the files and data objects and performs all the operations relative to the location of the project’s root file on the computer.</p>
<p>To create a new R Project select <em>File &gt; New Project</em> from the top RStudio menu.</p>
<p>Creating a new R project will create:</p>
<ul>
<li>A new project directory (folder)<br>
</li>
<li>A R project file (.Rproj) in the project folder that serves as a shortcut to open the project via RStudio</li>
</ul>
<p>Note:</p>
<ul>
<li>You can make sub-folders for data, scripts, etc.<br>
</li>
<li>All files produced by R scripts saved to the project will also save into the project folder</li>
</ul>
<p>You can try creating a new R Project, but for simplicity, <strong>you can download a folder already set up as an R Project from here: <a href="https://cgmoreh.github.io/SOC2069/SOC2069-Statistical-analysis.zip" class="uri">https://cgmoreh.github.io/SOC2069/SOC2069-Statistical-analysis.zip</a></strong></p>
<ol type="1">
<li>Download the compressed folder into a suitable location on your <strong>OneDrive - Newcastle University</strong> drive. This will allow you to access your files from any computer by logging into your university OneDrive account.</li>
<li>Once downloaded, use the <em>Compressed Folders Tools</em> to extract the contents of the compressed folder.</li>
</ol>
<p>The contents of the downloaded folder should look like this:</p>
<p><img src="images/file_structure.jpg" class="img-fluid"></p>
<p>If you double-click on <em>SOC2069-Statistical-analysis.Rproj</em>, the project will open in a new RStudio window. The advantage of having an .Rproj file in the folder that you are using is that you don’t have to worry about setting manually any paths to files that you will be using or producing; everything is stored relative to where the .Rproj file is located on your computer.</p>
</section>
<section id="task-2-using-r-scripts" class="level2">
<h2 class="anchored" data-anchor-id="task-2-using-r-scripts">Task 2: Using R scripts</h2>
<p>R scripts are special text documents where you can write and execute commands in the <code>R</code> programming language. You can create an R Script from within RStudio by going to <em>File &gt; New File &gt; R Script</em> (also CNTRL + SHIFT + N). We already have an example R script in the folder you have just downloaded: <strong>Lab6.R</strong>. You can click on that file to open it. It will load in the upper left panel of RStudio. This example R script contains mainly comments and a single command, a simple arithmetic operation (1 + 3 - 5 + 7). You can use this script file to copy/paste commands from this window into it so you can run the commands in R.</p>
</section>
<section id="task-3-explore-the-rstudio-main-panes" class="level2">
<h2 class="anchored" data-anchor-id="task-3-explore-the-rstudio-main-panes">Task 3: Explore the RStudio (main) Panes</h2>
<p>Let’s have a closer look at the four (main) panes of RStudio:</p>
<p><img src="./../GTA_R_intro/images/console_etc.png" class="img-fluid"></p>
<section id="the-r-console-pane" class="level3">
<h3 class="anchored" data-anchor-id="the-r-console-pane">The R Console Pane</h3>
<p>The R Console, by default the left or lower-left pane in R Studio, is the home of the R “engine”. This is where the commands are actually run and non-graphic outputs and error/warning messages appear. The <strong>Console</strong> is the direct interface to the <code>R</code> software itself; it’s what we get if instead of <code>RStudio</code> we open the <code>R</code> software: a direct interface to the <code>R</code> programming language, where we can type commands and <strong>where results/messages are printed</strong>.</p>
<p>You can directly enter and run commands in the R Console, but realize that these commands are not saved as they are when running commands from a script. For this reason, we should not use the <strong>Console</strong> pane directly too much. For typing commands that we want <code>R</code> to execute, we should instead use an <code>R</code> script file, where everything we type can be saved for later and complex analyses can be built up.</p>
</section>
<section id="the-source-pane" class="level3">
<h3 class="anchored" data-anchor-id="the-source-pane">The Source Pane</h3>
<p>This pane, by default in the upper-left, is a space to edit and run your scripts. This pane can also display datasets (data frames) for viewing.</p>
</section>
<section id="the-environment-pane" class="level3">
<h3 class="anchored" data-anchor-id="the-environment-pane">The Environment Pane</h3>
<p>This pane, by default the upper-right, is most often used to see brief summaries of objects in the R Environment in the current session. These objects could include imported, modified, or created datasets, parameters you have defined, or vectors or lists you have defined during analysis. You can click on the arrow next to a dataframe name to see its variables.</p>
<div class="notebox note">
<p><strong>Note</strong></p>
<p>If your Environment pane is empty, it means that you don’t have any “objects” loaded or created yet. We will be creating some objects later and we will also import an example dataset.</p>
</div>
</section>
<section id="files-plots-packages-help-etc" class="level3">
<h3 class="anchored" data-anchor-id="files-plots-packages-help-etc">Files, Plots, Packages, Help, etc</h3>
<p>The lower-right pane includes several tabs including plots (display of graphics including maps), help, a file library, and available R packages (including installation/update options).</p>
<p>You can arrange the panes in different ways, depending on your preferences, using <em>Tools &gt; Global Options in the top menu.</em> So the arrangement of panes may look different on different computers.</p>
</section>
</section>
<section id="task-4-start-using-functions-and-user-written-packages" class="level2">
<h2 class="anchored" data-anchor-id="task-4-start-using-functions-and-user-written-packages">Task 4: Start using functions and user-written packages</h2>
<p>Most work in R is done using <em>Functions</em>. The most common operations involving a function take the following generic form (think of an analogy of baking a loaf of bread):</p>
<p><img src="./../GTA_R_intro/images/bake_function.png" class="img-fluid"></p>
<p>It’s possible to <strong>create your own functions</strong>. This makes R extremely powerful and extendable. But instead of programming our own functions, we can rely on functions written by other people and bundled within <strong>packages</strong>. There are a large number of reliable, tested and oft-used packages containing functions that are particularly useful for social scientists. In this module, we will rely on several such user-written packages that extend the basic packages already bundled in with our <code>R</code> software (the so-called <em>base-R</em> packages and functions).</p>
<p>Packages are often available from the <em>Comprehensive R Archive Network</em> (CRAN) or private repositories such as <em>Bioconductor</em>, <em>GitHub</em> etc. Packages made available on CRAN can be installed using the command <code>install.packages("packagename")</code>. Once the package/library is installed (i.e.&nbsp;it is sitting somewhere on your computer), we then need to <em>load</em> it to the current R session using the command <code>library(packagename)</code>.</p>
<section id="installing-and-loading-the-tidyverse" class="level3">
<h3 class="anchored" data-anchor-id="installing-and-loading-the-tidyverse">Installing and loading the <code>tidyverse</code></h3>
<p>Let’s begin by installing and loading one of the most useful suite of packages called the ‘tidyverse’ (you can read more about the tidyverse <a href="https://www.tidyverse.org/">here</a>). Type or copy the command below into the Console window and click Enter (or write it in the <em>Lab6.R</em> script file and run it from there; in fact, this command is already there in the script):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now have access to functions contained in the ‘tidyverse’ bundle of packages. We can check the suite of packages that are loaded with the <code>tidyverse</code> library using a command from the <code>tidyverse</code> itself:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyverse_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we don’t want to load a package that we have downloaded - because maybe we only want to use a single function once and we don’t want to burden our computer’s memory - we can state explicitly which package the function is from by using the form <em>package::function</em>, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tidyverse<span class="sc">::</span><span class="fu">tidyverse_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I will sometimes use this form in the worksheets to clarify what package a function originates from, even if the package is loaded in the library.</p>
</section>
<section id="installing-some-other-packages" class="level3">
<h3 class="anchored" data-anchor-id="installing-some-other-packages">Installing some other packages</h3>
<div class="taskbox task">
<p>Now that you’ve installed a package, write the required functions in your R scripts to <strong>install</strong> and <strong>load</strong> the following two packages that we will be using later in this session:</p>
<ul>
<li>mosaic</li>
<li>sjmisc</li>
</ul>
</div>
</section>
<section id="load-a-dataset" class="level3">
<h3 class="anchored" data-anchor-id="load-a-dataset">Load a dataset</h3>
<p>So far we have learnt about some useful functions for installing and loading R packages. We can now look at functions that can be used to load a dataset into the Environment pane. We will load a dataset stored in <code>R</code>’s native format: .rds. There are other functions that are useful for loading data stored in other formats, particularly the most commonly used generic <em>comma separated values</em> (.csv) format, but we won’t use them now.</p>
<p>Let’s load the dataset called <code>ukhls_w8.rds</code> that is included in the <em>SOC2069-Statistical-analysis</em> project folder you downloaded earlier. We’ll use the <code>readRDS</code> function and the assignment operator (<code>&lt;-</code>) to create an object called “data” that will store the dataset (we can give any name to the object, but it’s useful to have something short that is easy to type because we will be typing it a lot when writing commands targetted to that dataset). Copy the following command into your R script and run it from there:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"ukhls_w8.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will only work if you are within an R Project; otherwise you need to provide the complete file path to the dataset.</p>
<p>You can now see that an object called “data” was created in the Environment pane, and next to it we have some information about the number of observations and variables in the dataset. If we click on the blue button with the white arrow before the name of the object, a list of variables and other information about them will roll down. If we click on the object’s name or info, the dataset will open in the Sources pane, just next to the R script file. This is equivalent to having run the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data)    </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the capital "V"; R is case-sensitive, so always pay attention; view(data) won't work</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can explore the dataset a bit. Only the first 50 columns (i.e.&nbsp;variables) are displayed, to see the next 50 you can click on arrow (&gt;) in the dataset window’s toolbar. Once you’ve had a quick look, you can close that view or return to the R script.</p>
</section>
</section>
</section>
<section id="exercise-2-explore-the-understanding-society-wave-8-dataset" class="level1">
<h1>Exercise 2: Explore the Understanding Society Wave 8 dataset</h1>
<p><code>About 15 minutes</code></p>
<hr>
<p>We have already read about the Understanding Society survey in Week 1 and have had a look at the survey website. From now on, we will be using that website a lot to read about the survey and in paricular the variables that we will use form Wave 8. The dataset that we loaded in R in the previous exercise is a reduced version of the original dataset that can be accessed via the <em>UK Data Service</em>. The following page provides a few details about the reduced dataset that we will be using in the labs and for the assignment task: <a href="https://cgmoreh.github.io/SOC2069/Data/ukhls_w8" target="_blank">https://cgmoreh.github.io/SOC2069/Data/ukhls_w8</a>. As noted there too, you should also makes extensive use of the Variable Search function on the Understanding Society website, as there we can find more detailed information about the variables and their associated questionnaire questions.</p>
<p>Have a look through the dataset description and variable list to get a good sense of the data. Select 3-4 variables from the dataset description that you find confusing and search for them on the Understanding <a href="https://www.understandingsociety.ac.uk/documentation/mainstage/dataset-documentation" target="_blank">Society’s Variable Search page</a>.</p>
</section>
<section id="exercise-3-basic-descriptive-statistics" class="level1">
<h1>Exercise 3: Basic descriptive statistics</h1>
<p><code>About 30 minutes</code></p>
<hr>
<p>Let’s learn a few functions that can help us explore variables through basic descriptive statistics.</p>
<section id="task-3.1-tabulate-categorical-variables" class="level2">
<h2 class="anchored" data-anchor-id="task-3.1-tabulate-categorical-variables">Task 3.1: Tabulate categorical variables</h2>
<p>Most of the variables in the dataset are categorical, so tabulating the frequency distributions of their categories can come handy. There are various ways for doing this in R, but one of the most convenient options is to use the <code>frq</code> function from the <code>{sjmisc}</code> package.</p>
<p>Let’s look, for instance, at the variable <code>sex</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> sjmisc<span class="sc">::</span><span class="fu">frq</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s decipher the code above:</p>
<ul>
<li><p>first, we assume that there is an object called ‘data’ in our Environment that contains the <em>ukhls_w8.rds</em>; unless we restarted RStudio or deleted it, the object should still be there from the first exercise;</p></li>
<li><p>the <code>%&gt;%</code> operator (called a <em>pipe</em>) is a function loaded with the <code>tidyverse</code> and allows objects and functions to be fed (i.e.&nbsp;piped) forward to other functions. Getting into the habit of using the “pipe” workflow is particularly useful as it makes combining a series of operations/commands easier to read and follow. Here, we take our dataset and pipe it forward so that we can easily refer to variables from that dataset (such as <em>sex</em>);</p></li>
<li><p>the remaining code applies the <code>frq</code> function from the <code>{sjmisc}</code> package to the variable <em>sex</em></p></li>
</ul>
<p>We could have written the following command, with the same result:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sjmisc<span class="sc">::</span><span class="fu">frq</span>(data<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or if we already have the <code>{sjmisc}</code> package loaded with the <code>library</code> command, then:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">frq</span>(data<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What we learn here is that another way of referring to variables within datasets is by using the <code>$</code> operator. Here, <code>data**$**sex</code> extracts the <em>sex</em> variable/column from the <em>data</em> object.</p>
<p>The resulting frequency table will be printed in the Console, and will look something like this:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>sex (x) &lt;categorical&gt; 
# total N=39293 valid N=39293 mean=1.54 sd=0.50

Value  |     N | Raw % | Valid % | Cum. %
-----------------------------------------
male   | 17925 | 45.62 |   45.62 |  45.62
female | 21368 | 54.38 |   54.38 | 100.00
&lt;NA&gt;   |     0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
</div>
<div class="cell" type="questionblock">
<div class="questionblock">
<p>
<strong>Question</strong>
</p>
<p>
Interpret the table:
</p>
<ul>
<li>
How many of the respondents in the data are <em>female</em>?
</li>
<li>
What is the percentage of <em>men</em> in the dataset?
</li>
<li>
Are there any missing values (NAs) on this variable?
</li>
</ul>
</div>
</div>
</section>
<section id="task-3.2-summarize-numeric-variables" class="level2">
<h2 class="anchored" data-anchor-id="task-3.2-summarize-numeric-variables">Task 3.2: Summarize numeric variables</h2>
<p>There are much fewer <em>numeric</em> variables in this dataset (an in sociological datasets in general). One that we have is the <em>age_dv</em> variable that codes respondents’ age. The base-R function <code>summary</code> is enough to get a basic summary of a quantitative/numeric type variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>age_dv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  16.00   34.00   49.00   48.77   63.00  102.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R functions don't always work with a pipe ( %&gt;% ) workflow; summary doesn't, so we use the `$` operator</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also use the <code>descr</code> function from <code>{sjmisc}</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> sjmisc<span class="sc">::</span><span class="fu">descr</span>(age_dv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
## Basic descriptive statistics

    var    type                                  label     n NA.prc  mean    sd
 age_dv numeric Age, derived from dob_dv and intdat_dv 39293      0 48.77 18.73
   se md trimmed       range iqr skew
 0.09 49   48.53 86 (16-102)  29 0.09</code></pre>
</div>
</div>
<p>This function allows more control, so we can fine-tune which statistics we want to print and ad some other options. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> sjmisc<span class="sc">::</span><span class="fu">descr</span>(age_dv, <span class="at">show =</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"NA.prc"</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"md"</span>, <span class="st">"range"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
## Basic descriptive statistics

    var     n NA.prc  mean    sd md       range
 age_dv 39293      0 48.77 18.73 49 86 (16-102)</code></pre>
</div>
</div>
<p>In this output, we selected some of the more useful statistics only and excluded the variable label. We could also use the <code>max.length</code> option in addition to <code>show</code> to set the maximum length of variable labels in the output, making it shorter if we wanted to. We can also include more than one variable in the function, which is useful for comparing several numeric variables.</p>
<p>The <code>c(...)</code> function used in the example above is used to combine values into vectors or lists. It is used very often in various contexts, so it is worth knowing about. Here, we used it to combine the names of the statistics we wanted to include within the <code>show</code> function.</p>
<div class="cell" type="questionblock">
<div class="questionblock">
<p>
<strong>Question</strong>
</p>
<p>
Interpret the table:
</p>
<ul>
<li>
What is the average (mean) age of the respondents in the dataset?
</li>
<li>
What about the median (md) age?
</li>
<li>
How spread out is the age of the respondents? (tip: the <em>standard deviation</em> (sd) is a good measure of spread)
</li>
<li>
What is the <em>minimum</em> and <em>maximum</em> age of the respondents? (tip: the <em>range</em> statistic contains this information)
</li>
<li>
Are there any missing values (NAs) on this variable?
</li>
</ul>
</div>
</div>
</section>
<section id="task-3.3-visualising-distributions" class="level2">
<h2 class="anchored" data-anchor-id="task-3.3-visualising-distributions">Task 3.3: Visualising distributions</h2>
<p>It is often useful to make a graph to visualise a variable, especially a <em>numeric</em> variable. A figure can often convey information in a much more efficient way that a statistic/number. One of the most useful graph types for visualising numeric variables is a <em>histogram</em>. Again, there are many functions available in R for producing graphs. Once you become more proficient and use R more often, it is very useful to learn the graphing workflow of the <code>ggplot2</code> package (included in the <code>tidyverse</code>), which builds up a graph canvas step by step using various elements. That allows the creation of highly customized figures of publishable quality. But for very basic graphs that we use only to get a general impression, we can use some more basic functions. The plotting functions included in the <code>mosaic</code> package can be useful for this purpose. For example, the <code>histogram</code> function from <code>{mosaic}</code> produces the following figure:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>( <span class="sc">~</span> age_dv, <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Worksheet_2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This function has a similar structure to the functions that we will use for statistical modelling, generically of the form <strong>goal(y ~ x, data = my_data)</strong>. In our case, we are only “modelling” one variable here, so the first (y-axis) object before the tilde (~) is missing. The data can be specified with the option <code>data = ...</code>. In our case, the actual name that we gave to our data object is <em>data</em>, so we have <code>data = data</code>.</p>
<p>We can also easily superimpose a <em>normal distribution</em> curve over the histogram to check whether the numeric variable is more or less normally distributed or not:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>( <span class="sc">~</span> age_dv, <span class="at">data =</span> data, <span class="at">fit =</span> <span class="st">"normal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Worksheet_2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Density plots</em> are also useful for this purpose:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>( <span class="sc">~</span> age_dv, <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Worksheet_2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also add a <em>categorical</em> variable to break down the graph into groups. For instance, we can use the <code>sex</code> variable that we are already familiar with to visualise the age distribution of <em>men</em> next to that of <em>women</em>. To do this, we add the categorical variable after a vertical bar (|):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>( <span class="sc">~</span> age_dv <span class="sc">|</span> sex, <span class="at">data =</span> data, <span class="at">fit =</span> <span class="st">"normal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Worksheet_2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What we can learn from all these figures is that the age distribution of our respondents is not perfectly normal, with a thicker left tail showing a higher numbers of under-30 year-olds.</p>
</section>
</section>
<section id="exercise-4-on-your-own" class="level1">
<h1>Exercise 4: On your own</h1>
<p>Make sure that you have copied all the commands from this page to your R script and that you have saved the script so you can access the commands at a later date.</p>
<p>If time allows, go on and select a few more variables from the dataset and explore them using the appropriate descriptive statistics using the functions we have practiced above.</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>